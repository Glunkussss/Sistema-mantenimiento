<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaciones - Sistema IUB</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/evaluaciones.css">

</head>
<body data-required-roles="rector,supervisor">
    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
    <div id="dashboard-header"></div>

    <main class="dashboard-main">
        <section class="controls-section">
            <div class="card">
                <div class="card-header">
                    <h3>üìä Gesti√≥n de Evaluaciones</h3>
                    <button class="btn btn-primary" onclick="showNewEvaluationModal()">+ Nueva Evaluaci√≥n</button>
                </div>
                <div class="controls-grid">
                    <div class="input-group">
                        <input type="text" id="searchInput" class="search-input" placeholder="üîç Buscar evaluaciones..." onkeyup="filterEvaluations()">
                    </div>
                    <div class="input-group">
                        <select id="tecnicoFilter" class="filter-select" onchange="filterEvaluations()">
                            <option value="">Todos los t√©cnicos</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <select id="puntajeFilter" class="filter-select" onchange="filterEvaluations()">
                            <option value="">Todos los puntajes</option>
                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5.0)</option>
                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê (4.0+)</option>
                            <option value="3">‚≠ê‚≠ê‚≠ê (3.0+)</option>
                            <option value="2">‚≠ê‚≠ê (2.0+)</option>
                            <option value="1">‚≠ê (1.0+)</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" onclick="refreshEvaluations()">üîÑ Actualizar</button>
                </div>
            </div>
        </section>
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-content">
                        <h3>Total Evaluaciones</h3>
                        <p class="stat-number" id="totalEvaluations">-</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚≠ê</div>
                    <div class="stat-content">
                        <h3>Promedio General</h3>
                        <p class="stat-number" id="averageScore">-</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-content">
                        <h3>T√©cnicos Evaluados</h3>
                        <p class="stat-number" id="evaluatedTechnicians">-</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìÖ</div>
                    <div class="stat-content">
                        <h3>Este Mes</h3>
                        <p class="stat-number" id="monthlyEvaluations">-</p>
                    </div>
                </div>
            </div>
        </section>
        <section class="table-section">
            <div class="card">
                <div class="table-header">
                    <h3>üìã Lista de Evaluaciones</h3>
                    <span class="user-count" id="evaluationCount">0 evaluaciones</span>
                </div>
                <div class="table-wrapper">
                    <table class="data-table" id="evaluationsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>T√©cnico</th>
                                <th>Supervisor</th>
                                <th>Puntaje</th>
                                <th>Fecha</th>
                                <th>Observaciones</th>
                                <th class="actions-col">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="evaluationsTableBody">
                            <tr class="loading-row">
                                <td colspan="7">
                                    <div class="loading-state">
                                        <div class="loading-spinner"></div>
                                        <p>Cargando evaluaciones...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>
    <div id="evaluationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">üìù Nueva Evaluaci√≥n</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="evaluationForm">
                    <div class="input-group">
                        <label for="tecnico_id">üë§ T√©cnico *</label>
                        <select id="tecnico_id" name="tecnico_id" required>
                            <option value="">Seleccionar t√©cnico...</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="puntaje">‚≠ê Puntaje *</label>
                        <select id="puntaje" name="puntaje" required>
                            <option value="">Seleccionar puntaje...</option>
                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excelente (5.0)</option>
                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Muy Bueno (4.0)</option>
                            <option value="3">‚≠ê‚≠ê‚≠ê Bueno (3.0)</option>
                            <option value="2">‚≠ê‚≠ê Regular (2.0)</option>
                            <option value="1">‚≠ê Deficiente (1.0)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="observaciones">üìù Observaciones</label>
                        <textarea id="observaciones" name="observaciones" rows="4" placeholder="Comentarios adicionales sobre el desempe√±o..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="saveEvaluation()" id="saveBtn">üíæ Guardar</button>
            </div>
        </div>
    </div>
    <div id="confirmModal" class="modal">
        <div class="modal-content confirm-modal">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Confirmar Eliminaci√≥n</h3>
                <button class="modal-close" onclick="closeConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>¬øEst√°s seguro de que deseas eliminar esta evaluaci√≥n?</p>
                <p><strong>Esta acci√≥n no se puede deshacer.</strong></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeConfirmModal()">Cancelar</button>
                <button type="button" class="btn btn-delete" onclick="confirmDelete()" id="confirmDeleteBtn">üóëÔ∏è Eliminar</button>
            </div>
        </div>
    </div>
    <script src="js/common.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/evaluaciones.js"></script>
</body>
</html>